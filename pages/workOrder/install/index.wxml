<!--pages/workOrder/install/index.wxml-->
<view style='margin-bottom:10px'></view>

<view class="work-item view-shadow">
  <view class='flex-row box-all' style='padding:5px;border-bottom:1px solid #F2F2F2'>
    <view class='flex-1'>{{orderDetail.wrCode}}</view>
    <view class='flex-1 work-order-content'>{{orderDetail.intall.pWrok.name}}</view>
  </view>

  <block wx:for="{{orderDetail.fromData}}" wx:key="*this">
    <view class='flex-row box-all border-bottom-gainsboro'>
      <view class='content-style flex-1 padding-5'>{{item.name}}</view>
      <block wx:if="{{item.name == '注意'}}">
        <view class='content-style padding-5' style='color:red;font-weight:bold;'>{{item.value!=null?item.value:'-'}}</view>
      </block>
      <block wx:else>
        <view class='content-style padding-5'>{{item.value!=null?item.value:'-'}}</view>
      </block>
    </view>
  </block>
</view>
<block wx:if="{{user.type != 2}}">

  <view class='middle-box'>
    <view class="weui-cell weui-cell_input">
      <view class='flex-row box-all'>
        <view class='flex-1 padding-5' style='margin-top:5px;'>{{date}}</view>
        <view class='order-type-icon'>安</view>
      </view>
    </view>
    <view class="weui-cell weui-cell_input">
      <view class='flex-row box-all'>
        <view class='flex-1 padding-5'>签入</view>
        <view class='padding-5 work-order-content' bindtap='locationSignIn'>去签入 ></view>
      </view>
    </view>

    <!-- <button class="weui-btn mini-btn" type="primary" bindtap='locationSignIn' size="mini">签入</button> -->
    <block wx:if="{{nowAddress!=''}}">
      <view class="weui-cell weui-cell_input">
        <view class='flex-row box-all'>
          <view class='flex-1 padding-5'>当前位置</view>
          <view class='padding-5 work-order-content' bindtap='locationSignIn'>{{nowAddress}}</view>
        </view>
      </view>
    </block>


    <view class="weui-cell weui-cell_input">
      <view class="weui-cell__hd">
        <view class="weui-label"></view>
      </view>
      <view class="weui-cell__bd">
      </view>
    </view>
    <!-- 备注 -->
    <view class="weui-cell weui-cell_input">
      <view class="weui-cell__hd">
        <view class="weui-label">备注</view>
      </view>
      <view class="weui-cell__bd">
        <input class="weui-input" bindinput='remarkChange' placeholder="备注" />
      </view>
    </view>

    <view class="border-bottom-gainsboro">
      <view class="weui-cells">
        <view class="weui-cell">
          <view class="weui-cell__bd">
            <view class="weui-uploader">
              <view class="weui-uploader__hd">
                <view class="weui-uploader__title">图片附件上传</view>
                <view class="weui-uploader__info">{{files.length}}</view>
              </view>
              <view class="weui-uploader__bd">
                <view class="weui-uploader__files" id="uploaderFiles">
                  <block wx:for="{{files}}" wx:key="*this">
                    <view class="weui-uploader__file" style='position:relative' id="{{item}}">
                      <image class='del-img' bindtap='delImage' data-currentImg='{{item}}' src='/images/del.png'></image>

                      <image class="weui-uploader__img" bindtap="previewImage" src="{{item}}" mode="aspectFill" />
                    </view>
                  </block>
                </view>
                <view class="weui-uploader__input-box">
                  <view class="weui-uploader__input" bindtap="chooseImage"></view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>

    <view class='content'>
      <view class="weui-cell__hd">
        <view class="weui-label">签字确认</view>
      </view>
      <block wx:if="{{signImg==''}}">
        <canvas class='firstCanvas' canvas-id="firstCanvas" bindtouchmove='move' bindtouchstart='start' bindtouchend='end' bindtouchcancel='cancel' bindlongtap='tap' disable-scroll='true' binderror='error'>
        </canvas>
      </block>
      <block wx:if="{{signImg!=''}}">
        <image src='{{signImg}}'></image>
      </block>

      <view class='flex-row'>
        <button class='mini-btn' type="primary" size='mini' bindtap='clearClick'>清除</button>
        <button class='mini-btn' type="primary" size='mini' bindtap='saveClick'>保存图片</button>
        <!-- <image id='signatureImg' src='{{signImage}}'></image> -->
      </view>
    </view>

    <view class="weui-cell weui-cell_input" style='margin-top:5px'>
      <view class='flex-row box-all'>
        <view class='flex-1 padding-5'>签出</view>
        <view class='padding-5 work-order-content' bindtap='loactionSignOut'>去签出 ></view>
      </view>
    </view>
    <block wx:if="{{outAddress!=''}}">
      <view class="weui-cell weui-cell_input">
        <view class='flex-row box-all'>
          <view class='flex-1 padding-5'>当前位置</view>
          <view class='padding-5 work-order-content'>{{outAddress}}</view>
        </view>
      </view>
    </block>


  </view>
  <view class="modal-mask" bindtap="hideModal" catchtouchmove="preventTouchMove" wx:if="{{showModal}}"></view>
  <view class="modal-dialog" wx:if="{{showModal}}">
    <view class="modal-title">确认机器编号</view>
    <view class="modal-content">
      <view class="modal-input">
        <input placeholder-class="input-holder" type="number" maxlength="100" bindinput="confirmChange" class="input" placeholder="请确认您安装的机器编号"></input>
      </view>
    </view>
    <view class="modal-footer">
      <view class="btn-cancel" bindtap="onCancel" data-status="cancel">取消</view>
      <view class="btn-confirm" bindtap="onConfirm" data-status="confirm">确定</view>
    </view>
  </view>
<comment-view comments="{{orderDetail.comments}}"></comment-view>
  <view class='bottom-btn-view flex-row'>
    <button class='flex-1 bottom-btn' bindtap='toCommit'>评论</button>
    <button class='flex-1 bottom-btn' bindtap='showDialogBtn'>提交</button>
  </view>
</block>
<block wx:if="{{user.type == 2}}">
  <button class='bottom-btn-view' bindtap='toCommit'>评论</button>
</block>
<comment-component showPopup="{{showPopup}}" commentVal="{{commentVal}}" bindtextAreaChange="textAreaChange" bindpathTo="pathTo" bindsubComment="subComment" binddelCommentImage="delCommentImage"></comment-component>